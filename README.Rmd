---
title: "COVID-19 Infection,Recovery, and Mortality Rates"
output: github_document
fig_width: 15
fig_height: 8
---

```{r include=FALSE}
source("setup/library.R")
source("setup/pipe1.R")
source("dataTables.R")
```

```{r include=FALSE}
# USmodel1 <- lm(log(confirms) ~ day , data = inUS)
# USmodel2 <- lm(log(confirms) ~ day, data = (inUS %>% slice((nrow(inUS)-7):(nrow(inUS)))) )
# USmodel3 <- lm(log(confirms) ~ day, data = (inUS %>% slice((nrow(inUS)-14):(nrow(inUS)))))
# USmodel4 <- lm(log(confirms) ~ day, data = (inUS %>% slice((nrow(inUS)-21):(nrow(inUS)))))
# 
# f1 <- function(x){return(USmodel1$coefficients[1] + USmodel1$coefficients[2]*x)}
# f2 <- function(x){return(USmodel2$coefficients[1] + USmodel2$coefficients[2]*x)}
# f3 <- function(x){return(USmodel3$coefficients[1] + USmodel3$coefficients[2]*x)}
# f4 <- function(x){return(USmodel4$coefficients[1] + USmodel4$coefficients[2]*x)}
```

*Plots:*
```{r echo=FALSE,fig.height= 8,fig.width=16}

t(0) %>% ggplot(mapping = aes(x = Longitude, y = Latitude)) +
  geom_point(mapping = aes(size = Confirmed),alpha = 1.5,color = "red") + labs(title = "Spatial Map of Number of Cases Depicted as Point Size")

#Worldwide
earth %>% tp %>% ggplot(mapping = aes(x = day,y = value)) + 
  geom_line(mapping = aes(color = `Rate Type`),size = 1) + 
  labs(x = "Days since January 22nd 2020",
       y = "Number of people worldwide",
       title = "Increase in Infection, Recovery, and Mortatilty Rate Worldwide")

# China
c$China %>% tp %>% ggplot(mapping = aes(x = day,y = value)) + 
  geom_line(mapping = aes(color = `Rate Type`),size = 1) + 
  labs(x = "Days since January 22nd 2020",
       y = "Number of people",
       title = "Increase in Infection, Recovery, and Mortatilty Rate in China")

#not in China
p <- c$China %>% tp %>% ggplot(mapping = aes(x = day,color = `Rate Type`))

p + geom_line(mapping = aes(y = value),size = 1) + 
  labs(x = "Days since January 22nd 2020",
       y = "Number of people worldwide",
       title = "Increase in Infection, Recovery, and Mortatilty Rate Outside China")

p + geom_line(mapping = aes(y = log(value)),size = 0.8) +
  labs(x = "Days since January 22nd 2020",
       y = "Log Number of people worldwide",
       title = "Log Increase in Infection, Recovery, and Mortatilty Rate Outside China")

#In US
p <- c$US %>% tp %>% ggplot(mapping = aes(x = day,color = `Rate Type`))

p + geom_line(mapping = aes(y = value),size = 1) +
  labs(x = "Days since January 22nd 2020",
       y = "Number of people in US",
       title = "Increase in Infection, Recovery, and Mortatilty Rate in US")

p + geom_line(mapping = aes(y = log(value)),size = 1) +
  labs(x = "Days since January 22nd 2020",
       y = "Log Number of people in US",
       title = "Log Increase in Infection, Recovery, and Mortatilty Rate in US")

#In Italy
c$Italy %>% tp %>% ggplot(mapping = aes(x = day,color = `Rate Type`)) +
  geom_line(mapping = aes(y = value),size = 1) +
  labs(x = "Days since January 22nd 2020",
       y = "Number of people in Italy",
       title = "Increase in Infection, Recovery, and Mortatilty Rate in Italy")

c$Italy %>% tp %>% ggplot(mapping = aes(x = day,color = `Rate Type`)) +
  geom_line(mapping = aes(y = log(value)),size = 1) +
  labs(x = "Days since January 22nd 2020",
       y = " Log Number of people in Italy",
       title = "Log Increase in Infection, Recovery, and Mortatilty Rate in Italy")
```
____
*US Rates:*
```{r echo=FALSE}
# source("US.R")
# 
# USrates <- c()
# for(i in 1:(nrow(c$US)-1)){
#   USrates[i] <- (c$US$confirms[i+1]/c$US$confirms[i])
# }
# 
# 
# nifty50 %>% ggplot(mapping = aes(x = day, color = `Rate Type`)) +
#   facet_wrap(~state) +
#   geom_line(mapping = aes(y = value))
# 
# 
# print(str_c("The average rate of growth in the US since 1-22-2020 is a ",(mean(USrates) - 1)," percent increase in confirmed cases daily"))
```

  *If it is increasing by 0% then this means there were no new cases in that day. In terms of exponential growth as this constant goes from  > 0  to  < 0 this could mean that the rate of increase in cases is decreasing and there is no longer exponential growth. Examining this rate in recent chunks allows us to gauge what the current situation is in terms of how it is growing. Any positive number means continued exponential growth. But if it is 0 or less it could mean that transmission will start to taper out.*

